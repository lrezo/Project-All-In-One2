/*!
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md.
 */
window.CKEditor5=window.CKEditor5||{},window.CKEditor5.watchdog=function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=10)}([function(t,e,r){"use strict";var n=r(2),o="object"==typeof self&&self&&self.Object===Object&&self,i=n.a||o||Function("return this")();e.a=i},function(t,e,r){"use strict";(function(t){var n=r(2),o="object"==typeof exports&&exports&&!exports.nodeType&&exports,i=o&&"object"==typeof t&&t&&!t.nodeType&&t,a=i&&i.exports===o&&n.a.process,s=function(){try{var t=i&&i.require&&i.require("util").types;return t||a&&a.binding&&a.binding("util")}catch(t){}}();e.a=s}).call(this,r(4)(t))},function(t,e,r){"use strict";(function(t){var r="object"==typeof t&&t&&t.Object===Object&&t;e.a=r}).call(this,r(9))},function(t,e,r){"use strict";(function(t){var n=r(0),o=r(6),i="object"==typeof exports&&exports&&!exports.nodeType&&exports,a=i&&"object"==typeof t&&t&&!t.nodeType&&t,s=a&&a.exports===i?n.a.Buffer:void 0,c=(s?s.isBuffer:void 0)||o.a;e.a=c}).call(this,r(4)(t))},function(t,e){t.exports=function(t){if(!t.webpackPolyfill){var e=Object.create(t);e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),Object.defineProperty(e,"exports",{enumerable:!0}),e.webpackPolyfill=1}return e}},function(t,e,r){t.exports=r(8)("./src/utils.js")},function(t,e,r){"use strict";e.a=function(){return!1}},function(t,e,r){"use strict";(function(t){var n=r(0),o="object"==typeof exports&&exports&&!exports.nodeType&&exports,i=o&&"object"==typeof t&&t&&!t.nodeType&&t,a=i&&i.exports===o?n.a.Buffer:void 0,s=a?a.allocUnsafe:void 0;e.a=function(t,e){if(e)return t.slice();var r=t.length,n=s?s(r):new t.constructor(r);return t.copy(n),n}}).call(this,r(4)(t))},function(t,e){t.exports=CKEditor5.dll},function(t,e){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(t){"object"==typeof window&&(r=window)}t.exports=r},function(t,e,r){"use strict";r.r(e);var n=r(5);class o{constructor(t){if(this.crashes=[],this.state="initializing",this._crashNumberLimit="number"==typeof t.crashNumberLimit?t.crashNumberLimit:3,this._now=Date.now,this._minimumNonErrorTimePeriod="number"==typeof t.minimumNonErrorTimePeriod?t.minimumNonErrorTimePeriod:5e3,this._boundErrorHandler=t=>{const e=t.error||t.reason;e instanceof Error&&this._handleError(e,t)},this._listeners={},!this._restart)throw new Error("The Watchdog class was split into the abstract `Watchdog` class and the `EditorWatchdog` class. Please, use `EditorWatchdog` if you have used the `Watchdog` class previously.")}setCreator(t){this._creator=t}setDestructor(t){this._destructor=t}destroy(){this._stopErrorHandling(),this._listeners={}}on(t,e){this._listeners[t]||(this._listeners[t]=[]),this._listeners[t].push(e)}off(t,e){this._listeners[t]=this._listeners[t].filter(t=>t!==e)}_fire(t,...e){const r=this._listeners[t]||[];for(const t of r)t.apply(this,[null,...e])}_startErrorHandling(){window.addEventListener("error",this._boundErrorHandler),window.addEventListener("unhandledrejection",this._boundErrorHandler)}_stopErrorHandling(){window.removeEventListener("error",this._boundErrorHandler),window.removeEventListener("unhandledrejection",this._boundErrorHandler)}_handleError(t,e){if(this._shouldReactToError(t)){this.crashes.push({message:t.message,stack:t.stack,filename:e.filename,lineno:e.lineno,colno:e.colno,date:this._now()});const r=this._shouldRestart();this.state="crashed",this._fire("stateChange"),this._fire("error",{error:t,causesRestart:r}),r?this._restart():(this.state="crashedPermanently",this._fire("stateChange"))}}_shouldReactToError(t){return t.is&&t.is("CKEditorError")&&void 0!==t.context&&null!==t.context&&"ready"===this.state&&this._isErrorComingFromThisItem(t)}_shouldRestart(){if(this.crashes.length<=this._crashNumberLimit)return!0;return(this.crashes[this.crashes.length-1].date-this.crashes[this.crashes.length-1-this._crashNumberLimit].date)/this._crashNumberLimit>this._minimumNonErrorTimePeriod}}var i=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)},a=r(0),s=function(){return a.a.Date.now()},c=/\s/;var u=function(t){for(var e=t.length;e--&&c.test(t.charAt(e)););return e},h=/^\s+/;var f=function(t){return t?t.slice(0,u(t)+1).replace(h,""):t},l=a.a.Symbol,d=Object.prototype,p=d.hasOwnProperty,_=d.toString,v=l?l.toStringTag:void 0;var b=function(t){var e=p.call(t,v),r=t[v];try{t[v]=void 0;var n=!0}catch(t){}var o=_.call(t);return n&&(e?t[v]=r:delete t[v]),o},y=Object.prototype.toString;var g=function(t){return y.call(t)},j=l?l.toStringTag:void 0;var m=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":j&&j in Object(t)?b(t):g(t)};var w=function(t){return null!=t&&"object"==typeof t};var O=function(t){return"symbol"==typeof t||w(t)&&"[object Symbol]"==m(t)},x=/^[-+]0x[0-9a-f]+$/i,E=/^0b[01]+$/i,P=/^0o[0-7]+$/i,A=parseInt;var S=function(t){if("number"==typeof t)return t;if(O(t))return NaN;if(i(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=i(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=f(t);var r=E.test(t);return r||P.test(t)?A(t.slice(2),r?2:8):x.test(t)?NaN:+t},C=Math.max,T=Math.min;var I=function(t,e,r){var n,o,a,c,u,h,f=0,l=!1,d=!1,p=!0;if("function"!=typeof t)throw new TypeError("Expected a function");function _(e){var r=n,i=o;return n=o=void 0,f=e,c=t.apply(i,r)}function v(t){return f=t,u=setTimeout(y,e),l?_(t):c}function b(t){var r=t-h;return void 0===h||r>=e||r<0||d&&t-f>=a}function y(){var t=s();if(b(t))return g(t);u=setTimeout(y,function(t){var r=e-(t-h);return d?T(r,a-(t-f)):r}(t))}function g(t){return u=void 0,p&&n?_(t):(n=o=void 0,c)}function j(){var t=s(),r=b(t);if(n=arguments,o=this,h=t,r){if(void 0===u)return v(h);if(d)return clearTimeout(u),u=setTimeout(y,e),_(h)}return void 0===u&&(u=setTimeout(y,e)),c}return e=S(e)||0,i(r)&&(l=!!r.leading,a=(d="maxWait"in r)?C(S(r.maxWait)||0,e):a,p="trailing"in r?!!r.trailing:p),j.cancel=function(){void 0!==u&&clearTimeout(u),f=0,n=h=o=u=void 0},j.flush=function(){return void 0===u?c:g(s())},j};var D=function(t,e,r){var n=!0,o=!0;if("function"!=typeof t)throw new TypeError("Expected a function");return i(r)&&(n="leading"in r?!!r.leading:n,o="trailing"in r?!!r.trailing:o),I(t,e,{leading:n,maxWait:e,trailing:o})};var z=function(){this.__data__=[],this.size=0};var F=function(t,e){return t===e||t!=t&&e!=e};var M=function(t,e){for(var r=t.length;r--;)if(F(t[r][0],e))return r;return-1},N=Array.prototype.splice;var W=function(t){var e=this.__data__,r=M(e,t);return!(r<0)&&(r==e.length-1?e.pop():N.call(e,r,1),--this.size,!0)};var k=function(t){var e=this.__data__,r=M(e,t);return r<0?void 0:e[r][1]};var U=function(t){return M(this.__data__,t)>-1};var R=function(t,e){var r=this.__data__,n=M(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this};function $(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}$.prototype.clear=z,$.prototype.delete=W,$.prototype.get=k,$.prototype.has=U,$.prototype.set=R;var L=$;var H=function(){this.__data__=new L,this.size=0};var Q=function(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r};var B=function(t){return this.__data__.get(t)};var V=function(t){return this.__data__.has(t)};var q,K=function(t){if(!i(t))return!1;var e=m(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e},G=a.a["__core-js_shared__"],Y=(q=/[^.]+$/.exec(G&&G.keys&&G.keys.IE_PROTO||""))?"Symbol(src)_1."+q:"";var J=function(t){return!!Y&&Y in t},X=Function.prototype.toString;var Z=function(t){if(null!=t){try{return X.call(t)}catch(t){}try{return t+""}catch(t){}}return""},tt=/^\[object .+?Constructor\]$/,et=Function.prototype,rt=Object.prototype,nt=et.toString,ot=rt.hasOwnProperty,it=RegExp("^"+nt.call(ot).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var at=function(t){return!(!i(t)||J(t))&&(K(t)?it:tt).test(Z(t))};var st=function(t,e){return null==t?void 0:t[e]};var ct=function(t,e){var r=st(t,e);return at(r)?r:void 0},ut=ct(a.a,"Map"),ht=ct(Object,"create");var ft=function(){this.__data__=ht?ht(null):{},this.size=0};var lt=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},dt=Object.prototype.hasOwnProperty;var pt=function(t){var e=this.__data__;if(ht){var r=e[t];return"__lodash_hash_undefined__"===r?void 0:r}return dt.call(e,t)?e[t]:void 0},_t=Object.prototype.hasOwnProperty;var vt=function(t){var e=this.__data__;return ht?void 0!==e[t]:_t.call(e,t)};var bt=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=ht&&void 0===e?"__lodash_hash_undefined__":e,this};function yt(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}yt.prototype.clear=ft,yt.prototype.delete=lt,yt.prototype.get=pt,yt.prototype.has=vt,yt.prototype.set=bt;var gt=yt;var jt=function(){this.size=0,this.__data__={hash:new gt,map:new(ut||L),string:new gt}};var mt=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t};var wt=function(t,e){var r=t.__data__;return mt(e)?r["string"==typeof e?"string":"hash"]:r.map};var Ot=function(t){var e=wt(this,t).delete(t);return this.size-=e?1:0,e};var xt=function(t){return wt(this,t).get(t)};var Et=function(t){return wt(this,t).has(t)};var Pt=function(t,e){var r=wt(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this};function At(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}At.prototype.clear=jt,At.prototype.delete=Ot,At.prototype.get=xt,At.prototype.has=Et,At.prototype.set=Pt;var St=At;var Ct=function(t,e){var r=this.__data__;if(r instanceof L){var n=r.__data__;if(!ut||n.length<199)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new St(n)}return r.set(t,e),this.size=r.size,this};function Tt(t){var e=this.__data__=new L(t);this.size=e.size}Tt.prototype.clear=H,Tt.prototype.delete=Q,Tt.prototype.get=B,Tt.prototype.has=V,Tt.prototype.set=Ct;var It=Tt;var Dt=function(t,e){for(var r=-1,n=null==t?0:t.length;++r<n&&!1!==e(t[r],r,t););return t},zt=function(){try{var t=ct(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();var Ft=function(t,e,r){"__proto__"==e&&zt?zt(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r},Mt=Object.prototype.hasOwnProperty;var Nt=function(t,e,r){var n=t[e];Mt.call(t,e)&&F(n,r)&&(void 0!==r||e in t)||Ft(t,e,r)};var Wt=function(t,e,r,n){var o=!r;r||(r={});for(var i=-1,a=e.length;++i<a;){var s=e[i],c=n?n(r[s],t[s],s,r,t):void 0;void 0===c&&(c=t[s]),o?Ft(r,s,c):Nt(r,s,c)}return r};var kt=function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n};var Ut=function(t){return w(t)&&"[object Arguments]"==m(t)},Rt=Object.prototype,$t=Rt.hasOwnProperty,Lt=Rt.propertyIsEnumerable,Ht=Ut(function(){return arguments}())?Ut:function(t){return w(t)&&$t.call(t,"callee")&&!Lt.call(t,"callee")},Qt=Array.isArray,Bt=r(3),Vt=/^(?:0|[1-9]\d*)$/;var qt=function(t,e){var r=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==r||"symbol"!=r&&Vt.test(t))&&t>-1&&t%1==0&&t<e};var Kt=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991},Gt={};Gt["[object Float32Array]"]=Gt["[object Float64Array]"]=Gt["[object Int8Array]"]=Gt["[object Int16Array]"]=Gt["[object Int32Array]"]=Gt["[object Uint8Array]"]=Gt["[object Uint8ClampedArray]"]=Gt["[object Uint16Array]"]=Gt["[object Uint32Array]"]=!0,Gt["[object Arguments]"]=Gt["[object Array]"]=Gt["[object ArrayBuffer]"]=Gt["[object Boolean]"]=Gt["[object DataView]"]=Gt["[object Date]"]=Gt["[object Error]"]=Gt["[object Function]"]=Gt["[object Map]"]=Gt["[object Number]"]=Gt["[object Object]"]=Gt["[object RegExp]"]=Gt["[object Set]"]=Gt["[object String]"]=Gt["[object WeakMap]"]=!1;var Yt=function(t){return w(t)&&Kt(t.length)&&!!Gt[m(t)]};var Jt=function(t){return function(e){return t(e)}},Xt=r(1),Zt=Xt.a&&Xt.a.isTypedArray,te=Zt?Jt(Zt):Yt,ee=Object.prototype.hasOwnProperty;var re=function(t,e){var r=Qt(t),n=!r&&Ht(t),o=!r&&!n&&Object(Bt.a)(t),i=!r&&!n&&!o&&te(t),a=r||n||o||i,s=a?kt(t.length,String):[],c=s.length;for(var u in t)!e&&!ee.call(t,u)||a&&("length"==u||o&&("offset"==u||"parent"==u)||i&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||qt(u,c))||s.push(u);return s},ne=Object.prototype;var oe=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||ne)};var ie=function(t,e){return function(r){return t(e(r))}},ae=ie(Object.keys,Object),se=Object.prototype.hasOwnProperty;var ce=function(t){if(!oe(t))return ae(t);var e=[];for(var r in Object(t))se.call(t,r)&&"constructor"!=r&&e.push(r);return e};var ue=function(t){return null!=t&&Kt(t.length)&&!K(t)};var he=function(t){return ue(t)?re(t):ce(t)};var fe=function(t,e){return t&&Wt(e,he(e),t)};var le=function(t){var e=[];if(null!=t)for(var r in Object(t))e.push(r);return e},de=Object.prototype.hasOwnProperty;var pe=function(t){if(!i(t))return le(t);var e=oe(t),r=[];for(var n in t)("constructor"!=n||!e&&de.call(t,n))&&r.push(n);return r};var _e=function(t){return ue(t)?re(t,!0):pe(t)};var ve=function(t,e){return t&&Wt(e,_e(e),t)},be=r(7);var ye=function(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e};var ge=function(t,e){for(var r=-1,n=null==t?0:t.length,o=0,i=[];++r<n;){var a=t[r];e(a,r,t)&&(i[o++]=a)}return i};var je=function(){return[]},me=Object.prototype.propertyIsEnumerable,we=Object.getOwnPropertySymbols,Oe=we?function(t){return null==t?[]:(t=Object(t),ge(we(t),(function(e){return me.call(t,e)})))}:je;var xe=function(t,e){return Wt(t,Oe(t),e)};var Ee=function(t,e){for(var r=-1,n=e.length,o=t.length;++r<n;)t[o+r]=e[r];return t},Pe=ie(Object.getPrototypeOf,Object),Ae=Object.getOwnPropertySymbols?function(t){for(var e=[];t;)Ee(e,Oe(t)),t=Pe(t);return e}:je;var Se=function(t,e){return Wt(t,Ae(t),e)};var Ce=function(t,e,r){var n=e(t);return Qt(t)?n:Ee(n,r(t))};var Te=function(t){return Ce(t,he,Oe)};var Ie=function(t){return Ce(t,_e,Ae)},De=ct(a.a,"DataView"),ze=ct(a.a,"Promise"),Fe=ct(a.a,"Set"),Me=ct(a.a,"WeakMap"),Ne=Z(De),We=Z(ut),ke=Z(ze),Ue=Z(Fe),Re=Z(Me),$e=m;(De&&"[object DataView]"!=$e(new De(new ArrayBuffer(1)))||ut&&"[object Map]"!=$e(new ut)||ze&&"[object Promise]"!=$e(ze.resolve())||Fe&&"[object Set]"!=$e(new Fe)||Me&&"[object WeakMap]"!=$e(new Me))&&($e=function(t){var e=m(t),r="[object Object]"==e?t.constructor:void 0,n=r?Z(r):"";if(n)switch(n){case Ne:return"[object DataView]";case We:return"[object Map]";case ke:return"[object Promise]";case Ue:return"[object Set]";case Re:return"[object WeakMap]"}return e});var Le=$e,He=Object.prototype.hasOwnProperty;var Qe=function(t){var e=t.length,r=new t.constructor(e);return e&&"string"==typeof t[0]&&He.call(t,"index")&&(r.index=t.index,r.input=t.input),r},Be=a.a.Uint8Array;var Ve=function(t){var e=new t.constructor(t.byteLength);return new Be(e).set(new Be(t)),e};var qe=function(t,e){var r=e?Ve(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.byteLength)},Ke=/\w*$/;var Ge=function(t){var e=new t.constructor(t.source,Ke.exec(t));return e.lastIndex=t.lastIndex,e},Ye=l?l.prototype:void 0,Je=Ye?Ye.valueOf:void 0;var Xe=function(t){return Je?Object(Je.call(t)):{}};var Ze=function(t,e){var r=e?Ve(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)};var tr=function(t,e,r){var n=t.constructor;switch(e){case"[object ArrayBuffer]":return Ve(t);case"[object Boolean]":case"[object Date]":return new n(+t);case"[object DataView]":return qe(t,r);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return Ze(t,r);case"[object Map]":return new n;case"[object Number]":case"[object String]":return new n(t);case"[object RegExp]":return Ge(t);case"[object Set]":return new n;case"[object Symbol]":return Xe(t)}},er=Object.create,rr=function(){function t(){}return function(e){if(!i(e))return{};if(er)return er(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}}();var nr=function(t){return"function"!=typeof t.constructor||oe(t)?{}:rr(Pe(t))};var or=function(t){return w(t)&&"[object Map]"==Le(t)},ir=Xt.a&&Xt.a.isMap,ar=ir?Jt(ir):or;var sr=function(t){return w(t)&&"[object Set]"==Le(t)},cr=Xt.a&&Xt.a.isSet,ur=cr?Jt(cr):sr,hr={};hr["[object Arguments]"]=hr["[object Array]"]=hr["[object ArrayBuffer]"]=hr["[object DataView]"]=hr["[object Boolean]"]=hr["[object Date]"]=hr["[object Float32Array]"]=hr["[object Float64Array]"]=hr["[object Int8Array]"]=hr["[object Int16Array]"]=hr["[object Int32Array]"]=hr["[object Map]"]=hr["[object Number]"]=hr["[object Object]"]=hr["[object RegExp]"]=hr["[object Set]"]=hr["[object String]"]=hr["[object Symbol]"]=hr["[object Uint8Array]"]=hr["[object Uint8ClampedArray]"]=hr["[object Uint16Array]"]=hr["[object Uint32Array]"]=!0,hr["[object Error]"]=hr["[object Function]"]=hr["[object WeakMap]"]=!1;var fr=function t(e,r,n,o,a,s){var c,u=1&r,h=2&r,f=4&r;if(n&&(c=a?n(e,o,a,s):n(e)),void 0!==c)return c;if(!i(e))return e;var l=Qt(e);if(l){if(c=Qe(e),!u)return ye(e,c)}else{var d=Le(e),p="[object Function]"==d||"[object GeneratorFunction]"==d;if(Object(Bt.a)(e))return Object(be.a)(e,u);if("[object Object]"==d||"[object Arguments]"==d||p&&!a){if(c=h||p?{}:nr(e),!u)return h?Se(e,ve(c,e)):xe(e,fe(c,e))}else{if(!hr[d])return a?e:{};c=tr(e,d,u)}}s||(s=new It);var _=s.get(e);if(_)return _;s.set(e,c),ur(e)?e.forEach((function(o){c.add(t(o,r,n,o,e,s))})):ar(e)&&e.forEach((function(o,i){c.set(i,t(o,r,n,i,e,s))}));var v=l?void 0:(f?h?Ie:Te:h?_e:he)(e);return Dt(v||e,(function(o,i){v&&(o=e[i=o]),Nt(c,i,t(o,r,n,i,e,s))})),c};var lr=function(t,e){return fr(t,5,e="function"==typeof e?e:void 0)},dr=Function.prototype,pr=Object.prototype,_r=dr.toString,vr=pr.hasOwnProperty,br=_r.call(Object);var yr=function(t){if(!w(t)||"[object Object]"!=m(t))return!1;var e=Pe(t);if(null===e)return!0;var r=vr.call(e,"constructor")&&e.constructor;return"function"==typeof r&&r instanceof r&&_r.call(r)==br};var gr=function(t){return w(t)&&1===t.nodeType&&!yr(t)};function jr(t,e=new Set){const r=[t],n=new Set;for(;r.length>0;){const t=r.shift();if(!(n.has(t)||mr(t)||e.has(t)))if(n.add(t),t[Symbol.iterator])try{for(const e of t)r.push(e)}catch(t){}else for(const e in t)"defaultValue"!==e&&r.push(t[e])}return n}function mr(t){const e=Object.prototype.toString.call(t),r=typeof t;return"number"===r||"boolean"===r||"string"===r||"symbol"===r||"function"===r||"[object Date]"===e||"[object RegExp]"===e||"[object Module]"===e||null==t||t instanceof EventTarget||t instanceof Event}function wr(t,e,r=new Set){if(t===e&&("object"==typeof(n=t)&&null!==n))return!0;var n;const o=jr(t,r),i=jr(e,r);for(const t of o)if(i.has(t))return!0;return!1}class Or extends o{constructor(t,e={}){super(e),this._editor=null,this._throttledSave=D(this._save.bind(this),"number"==typeof e.saveInterval?e.saveInterval:5e3),this._creator=(e,r)=>t.create(e,r),this._destructor=t=>t.destroy()}get editor(){return this._editor}get _item(){return this._editor}_restart(){return Promise.resolve().then(()=>(this.state="initializing",this._fire("stateChange"),this._destroy())).catch(t=>{console.error("An error happened during the editor destroying.",t)}).then(()=>{if("string"==typeof this._elementOrData)return this.create(this._data,this._config,this._config.context);{const t=Object.assign({},this._config,{initialData:this._data});return this.create(this._elementOrData,t,t.context)}}).then(()=>{this._fire("restart")})}create(t=this._elementOrData,e=this._config,r){return Promise.resolve().then(()=>(super._startErrorHandling(),this._elementOrData=t,this._config=this._cloneEditorConfiguration(e)||{},this._config.context=r,this._creator(t,this._config))).then(t=>{this._editor=t,t.model.document.on("change:data",this._throttledSave),this._lastDocumentVersion=t.model.document.version,this._data=this._getData(),this.state="ready",this._fire("stateChange")})}destroy(){return Promise.resolve().then(()=>(this.state="destroyed",this._fire("stateChange"),super.destroy(),this._destroy()))}_destroy(){return Promise.resolve().then(()=>{this._stopErrorHandling(),this._throttledSave.flush();const t=this._editor;return this._editor=null,this._destructor(t)})}_save(){const t=this._editor.model.document.version;if(t!==this._lastDocumentVersion)try{this._data=this._getData(),this._lastDocumentVersion=t}catch(t){console.error(t,"An error happened during restoring editor data. Editor will be restored from the previously saved data.")}}_setExcludedProperties(t){this._excludedProps=t}_getData(){const t={};for(const e of this._editor.model.document.getRootNames())t[e]=this._editor.data.get({rootName:e});return t}_isErrorComingFromThisItem(t){return wr(this._editor,t.context,this._excludedProps)}_cloneEditorConfiguration(t){return lr(t,(t,e)=>gr(t)||"context"===e?t:void 0)}}class xr{constructor(){this._promiseQueue=Promise.resolve(),this._onEmptyCallbacks=[]}onEmpty(t){this._onEmptyCallbacks.push(t)}enqueue(t){let e;const r=this._promiseQueue.then(t).then(()=>{this._promiseQueue===e&&this._onEmptyCallbacks.forEach(t=>t())});return e=this._promiseQueue=r.catch(()=>{}),r}}e.default={ContextWatchdog:class extends o{constructor(t,e={}){super(e),this._watchdogs=new Map,this._watchdogConfig=e,this._context=null,this._contextProps=new Set,this._actionQueue=new xr,this._creator=e=>t.create(e),this._destructor=t=>t.destroy(),this._actionQueue.onEmpty(()=>{"initializing"===this.state&&(this.state="ready",this._fire("stateChange"))})}get context(){return this._context}create(t={}){return this._actionQueue.enqueue(()=>(this._contextConfig=t,this._create()))}getItem(t){return this._getWatchdog(t)._item}getItemState(t){return this._getWatchdog(t).state}add(t){const e=Object(n.toArray)(t);return this._actionQueue.enqueue(()=>{if("destroyed"===this.state)throw new Error("Cannot add items to destroyed watchdog.");if(!this._context)throw new Error("Context was not created yet. You should call the `ContextWatchdog#create()` method first.");return Promise.all(e.map(t=>{let e;if(this._watchdogs.has(t.id))throw new Error(`Item with the given id is already added: '${t.id}'.`);if("editor"===t.type)return e=new Or(this._watchdogConfig),e.setCreator(t.creator),e._setExcludedProperties(this._contextProps),t.destructor&&e.setDestructor(t.destructor),this._watchdogs.set(t.id,e),e.on("error",(r,{error:n,causesRestart:o})=>{this._fire("itemError",{itemId:t.id,error:n}),o&&this._actionQueue.enqueue(()=>new Promise(r=>{e.on("restart",function n(){e.off("restart",n),this._fire("itemRestart",{itemId:t.id}),r()}.bind(this))}))}),e.create(t.sourceElementOrData,t.config,this._context);throw new Error(`Not supported item type: '${t.type}'.`)}))})}remove(t){const e=Object(n.toArray)(t);return this._actionQueue.enqueue(()=>Promise.all(e.map(t=>{const e=this._getWatchdog(t);return this._watchdogs.delete(t),e.destroy()})))}destroy(){return this._actionQueue.enqueue(()=>(this.state="destroyed",this._fire("stateChange"),super.destroy(),this._destroy()))}_restart(){return this._actionQueue.enqueue(()=>(this.state="initializing",this._fire("stateChange"),this._destroy().catch(t=>{console.error("An error happened during destroying the context or items.",t)}).then(()=>this._create()).then(()=>this._fire("restart"))))}_create(){return Promise.resolve().then(()=>(this._startErrorHandling(),this._creator(this._contextConfig))).then(t=>(this._context=t,this._contextProps=jr(this._context),Promise.all(Array.from(this._watchdogs.values()).map(t=>(t._setExcludedProperties(this._contextProps),t.create(void 0,void 0,this._context))))))}_destroy(){return Promise.resolve().then(()=>{this._stopErrorHandling();const t=this._context;return this._context=null,this._contextProps=new Set,Promise.all(Array.from(this._watchdogs.values()).map(t=>t.destroy())).then(()=>this._destructor(t))})}_getWatchdog(t){const e=this._watchdogs.get(t);if(!e)throw new Error(`Item with the given id was not registered: ${t}.`);return e}_isErrorComingFromThisItem(t){for(const e of this._watchdogs.values())if(e._isErrorComingFromThisItem(t))return!1;return wr(this._context,t.context)}},EditorWatchdog:Or,Watchdog:o}}]).default;